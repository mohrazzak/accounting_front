import{A as v,r,K as k,V as C,W as c,X as M,Y as d,Z as f,a as l,F as O,j as h,J as j,$ as V,H as Y,a0 as G,a1 as J,a2 as K}from"./index-f69be7d7.js";import{u as R,M as X,a as Z}from"./useTable-ed21e2f1.js";import{C as L}from"./CustomTableHeading-e03faf26.js";import{P as z}from"./PageHeading-c7717559.js";import"./IconButton-5e93c969.js";import"./Toolbar-34ee48fc.js";const b="اليومية",T={accountId:"",id:"",accountName:"",value:"",values:"",billType:"",note:""},ne=()=>{var g;const{data:n,yesterday:I,today:S,isLoading:Q,isSuccess:U}=v(e=>e.dailyRows),[t,u]=r.useState(new Date),F=t||Date.now();var W=new Date(F);const A=()=>{const a=new Date(t.getTime()-864e5);u(a)},E=()=>{const a=new Date(t.getTime()+864e5);u(a)},o=v(e=>e.users),p=n==null?void 0:n.map(({id:e,values:a,value:_,billType:$,note:B,UserId:H,isDaily:P,User:s})=>P?{id:e,values:a,value:_,billType:$,note:B,accountId:H,accountName:s==null?void 0:s.name,accountType:s==null?void 0:s.userType}:null).filter(e=>e!==null),i=k();r.useEffect(()=>{i(C())},[]),r.useEffect(()=>{i(c({isDaily:!0,date:{month:t.toLocaleString().split("/")[0],day:t.toLocaleString().split("/")[1],year:t.toLocaleString().split("/")[2].split(",")[0]}}))},[t]);const{dialog:q,setDialog:y,handleOpenAddDialog:x}=R(T),m={add:e=>{const a={isDaily:!0,userId:e.accountId,value:parseFloat(e.value,10),values:parseFloat(e.values,10),billType:e.billType,note:e.note};i(G(a)).then(()=>{i(c({isDaily:!0,date:{month:t.toLocaleString().split("/")[0],day:t.toLocaleString().split("/")[1],year:t.toLocaleString().split("/")[2].split(",")[0]}}))})},edit:e=>{const a={isDaily:!0,userId:e.accountId,value:parseFloat(e.value,10),values:parseFloat(e.values,10),billType:e.billType,note:e.note,id:e.id};i(J(a)).then(()=>{i(c({all:!1,userId:null,isDaily:!0}))})},delete:e=>{i(K(e))}},w=M({accountId:d().required("يرجى إدخال اسم الحساب"),value:f().required("يرجى إدخال المبلغ"),values:f().required("يرجى إدخال القيمة"),note:d(),billType:d().required("يرجى اختيار نوع الفاتورة")}),N=(g=o==null?void 0:o.data)==null?void 0:g.map(e=>({value:e.name,id:e.id,type:e.userType})),D=[{id:"id",label:"رقم الفاتورة",minWidth:70,align:"center",isField:!1,isLink:!0,isInvoice:!0},{id:"accountId",label:"ايدي الحساب",minWidth:80,align:"center",isField:!0,isLink:!0,options:N,required:!0},{id:"accountName",label:"اسم الحساب",minWidth:150,align:"left"},{id:"value",label:"المبلغ",minWidth:100,align:"center",format:e=>e.toLocaleString("en-US"),isField:!0,required:!0,isBill:!0},{id:"values",label:"القيمة",minWidth:50,align:"center",format:e=>e.toLocaleString("en-US"),isField:!0,isBill:!0},{id:"billType",label:"نوع الفاتورة",type:"select",options:[{value:"ادخال",id:"ادخال"},{value:"صادر",id:"صادر"},{value:"مصروف",id:"مصروف"},{value:"سحوبات",id:"سحوبات"}],required:!0,isField:!0},{id:"note",label:"ملاحظة",minWidth:170,align:"left",isField:!0}];return l(O,{children:h(j,{children:[l(z,{title:"صفحة اليومية",isDaily:!0,date:W,onReduce:A,onIncrease:E}),h(V,{children:[l(L,{rows:{...I,title:"الاساس"}}),l(X,{COLUMNS:D,deletedLabel:`فاتورة ${b}`,setDialog:y,rows:p,dispatchers:m}),l(L,{rows:{...S,title:"المدور"}}),l(Y,{variant:"contained",sx:{height:"60px",margin:"2rem auto",display:"block",width:"50%"},color:"error",onClick:x,children:"إضافة فاتورة جديدة"})]}),l(Z,{title:`فاتورة ${b}`,dialog:q,setDialog:y,ROW_INTIAL_VALUE:T,validationSchema:w,FIELDS:D.filter(e=>e.isField),rows:p,dispatchers:m})]})})};export{ne as default};
